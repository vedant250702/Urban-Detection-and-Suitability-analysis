# Urban Building Mask Detection

This project performs **building footprint segmentation** using the **MIT Buildings Dataset**, generating **urban masks** that can be exported and used in GIS platforms such as **ArcGIS**.  
A U-Net model is trained to segment building structures from satellite imagery, producing high-quality binary masks for further spatial analysis.

## Project Overview

- **Dataset:** MIT Buildings Dataset  
- **Model:** U-Net (PyTorch)  
- **Goal:**  
  - Detect building footprints from satellite tiles  
  - Generate binary masks of urban areas  
  - Export the masks into TIFF format for integration with ArcGIS

## Repository Structure

```text
.
â”œâ”€â”€ Images/                    # Sample satellite images and result previews for the readme.md file
â”œâ”€â”€ models/
â”‚   â””â”€â”€ unet_best.pth          # Trained model checkpoint 
â”‚   â””â”€â”€ history.json           # Trained model 
â”‚   â””â”€â”€ Plots.png              # Trained model 
â”‚
â”œâ”€â”€ Predictions/
â”‚   â”œâ”€â”€ main.ipynb             # Inference notebook
â”‚   â”œâ”€â”€ Unet.py                # Clean U-Net architecture
â”‚   â””â”€â”€ Tiff/                  # Exported GeoTIFF masks 
â”‚
â”œâ”€â”€ ModelTraining.ipynb        # Complete training pipeline
â”œâ”€â”€ ArcGIS project file.zip    # ArcGIS Pro project with
â”œâ”€â”€ EarthEngine3.js            # Google Earth Engine export 
â”œâ”€â”€ .gitignore
â””â”€â”€ .gitattributes             # Git LFS settings
```



## Model Training

The U-Net model is trained using the MIT Buildings Dataset with:

- Images (512 x 512) as input to the model
- Data augmentation  
- BCE loss  
- Adam optimizer  

Training pipeline: `ModelTraining.ipynb`

## Inference / Mask Generation

To generate building masks:

1. Load `models/unet_best.pth`
2. Pass satellite tiles into the model
3. Export predictions as PNG or TIFF

The study area selected for this project was Pune. A high-resolution TIFF file covering the entire region was downloaded and then divided into 512 Ã— 512 pixel tiles. Each tile was processed through the deep learning model to generate predictions. After obtaining the predictions for all tiles, they were merged back together to reconstruct the original large TIFF. The reconstructed output was then imported into ArcGIS for further spatial analysis.

Tiling and merging code: `Predictions/main.ipynb`

## GIS Integration

The generated masks can be imported into **ArcGIS Pro** for:
- Urban suitability analysis  
- Change detection  
 


##  ArcGIS Workflow & Spatial Analysis

After generating the building masks using the U-Net model, the outputs were imported into **ArcGIS Pro** for further spatial analysis.  
The GIS workflow automates post-processing, performs change detection, and identifies suitable areas for development.

---

## ArcGIS Model Builder Automation

A custom **Model Builder** pipeline was created to automate:

- Importing predicted masks  
- Raster preprocessing  
- Binary reclassification  
- Raster calculation for change detection in urban
- Raster calculation for finding land suitability for urban buildings


This ensures reproducible and scalable spatial analysis.

![Model Builder Workflow](Images/ModelBuilder.png)

---

## Urban Mask Generated by Deep Learning

The U-Net model detects building footprints and produces a binary mask that can be visualized in ArcGIS.

### ðŸ”¹ Original Urban Tile  
![Urban Image](Images/UrbanImage.png)

### ðŸ”¹ Predicted Mask  
![Urban Mask](Images/UrbanMask.png)

---


## Urban Change Detection (2016 â†’ 2023)

Using satellite images from 2016 and 2023, ArcGIS computes:

- Built-up expansion  
- Loss of open land  
- Urban growth hotspots

### ðŸ”¹ 2016 Image  
![2016 Satellite](Images/Pune_2016.png)

### ðŸ”¹ 2023 Image  
![2023 Satellite](Images/Pune_2023.png)


### **Formula Used**
Urban_change = Urban_post_mask - Urban_pre_mask

### ðŸ”¹ Change Visualization  
2016 vs 2023

| Year | Image |
|------|--------|
| 2016 | ![2016 Change](Images/change_2016.png) |
| 2023 | ![2023 Change](Images/change_2023.png) |
| 2016-2023 | ![Change Mask](Images/change_mask.png) |
---


## Suitability Analysis

Using the predicted mask, ArcGIS identifies **free and suitable areas** that are:

- Non-built-up  
- Not overlapping with urban regions  
- Spatially feasible for development

### ðŸ“Œ Suitability Formula
```python
Con(
    ("%NDWI_post.tif%" < 0) &
    ("%NDVI_post.tif%" < 0.3) &
    ("%NDBI_post.tif%" < -0.1) &
    ("%Slope_post.tif%" <= 15) &
    ("%Post_Urban%" != 1),
    1,
    0
)
```

### ðŸ”¹ Suitable Locations  
![Free Suitable Places](Images/FreeSuitablePlaces.png)

---

## Summary of ArcGIS Tasks

- Automated processing using **Model Builder**  
- Performed **urban growth change detection**  
- Derived **urban masks** from ML predictions  
- Visualized and analyzed suitability areas  



